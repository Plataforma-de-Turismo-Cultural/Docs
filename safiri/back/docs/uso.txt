Perfeito ğŸ‘Œ Vamos entÃ£o explicar **a sequÃªncia de funcionamento completa do teu projeto Django**, com base na estrutura que estÃ¡s a usar â€” incluindo `apps.core`, `apps.users` e `apps.posts` â€” para perceberes **como tudo se liga e em que ordem o Django processa cada parte atÃ© aos dados no banco**.

---

## âš™ï¸ 1. Estrutura geral do projeto

O Django organiza o projeto em **aplicaÃ§Ãµes (apps)** independentes, cada uma com:

* `models.py` â†’ estrutura dos dados (tabelas)
* `serializers.py` â†’ transformaÃ§Ã£o entre modelos e JSON
* `views.py` â†’ lÃ³gica de negÃ³cios (CRUD, regras)
* `urls.py` â†’ rotas da API
* `admin.py` â†’ painel administrativo
* `tests.py` â†’ testes automÃ¡ticos (opcional)
* `apps.py` â†’ configuraÃ§Ã£o da app

No teu caso tens:

```
apps/
 â”£ core/
 â”£ users/
 â”— posts/
```

Cada uma tem o seu conjunto de models, views, serializers e urls.

---

## ğŸ§© 2. Ordem de funcionamento (ao iniciar o projeto)

### (a) `manage.py runserver`

Quando executas:

```bash
python manage.py runserver
```

O Django:

1. Carrega as configuraÃ§Ãµes de `settings.py`;
2. Inicializa as apps listadas em `INSTALLED_APPS`;
3. Conecta-se ao banco de dados definido em `DATABASES`;
4. LÃª as rotas do ficheiro principal `urls.py`:

   ```python
   urlpatterns = [
       path('admin/', admin.site.urls),
       path('api/', include('apps.core.urls')),
       path('api/', include('apps.posts.urls')),
       path('api/', include('apps.users.urls')),
   ]
   ```

   Assim, o Django passa todas as requisiÃ§Ãµes que comeÃ§am com `/api/` para as respetivas apps.

---

## ğŸ”„ 3. SequÃªncia de funcionamento da API

Quando o cliente (frontend ou Postman, por exemplo) envia um pedido para o servidor, segue esta sequÃªncia:

### Exemplo: GET `/api/users/`

1. **O Django Router** (em `apps.users.urls`) recebe a rota:

   ```python
   router.register(r'users', UserViewSet)
   ```

   ğŸ‘‰ isto cria automaticamente endpoints:

   * `GET /api/users/` â†’ lista de utilizadores
   * `POST /api/users/` â†’ cria um novo utilizador
   * `GET /api/users/{id}/` â†’ detalhe
   * `PUT/PATCH /api/users/{id}/` â†’ atualizaÃ§Ã£o
   * `DELETE /api/users/{id}/` â†’ remoÃ§Ã£o

2. **O Django chama a `UserViewSet`** em `views.py`:

   ```python
   class UserViewSet(viewsets.ModelViewSet):
       queryset = User.objects.all()
       serializer_class = UserSerializer
   ```

3. **O `queryset`** acessa o banco de dados via ORM (Object Relational Mapper).

4. **O `serializer`** converte os objetos `User` para JSON.

5. **O Django Rest Framework (DRF)** retorna a resposta JSON para o cliente.

---

## ğŸ§± 4. InserÃ§Ã£o de dados (via API ou Admin)

### ğŸ§© OpÃ§Ã£o 1 â€” Painel administrativo (`/admin`)

1. Vais atÃ© `/admin/`;
2. Inseres manualmente os dados (ex: User, Post, etc.);
3. O Django cria os registos diretamente no banco (atravÃ©s dos models).

### ğŸ§© OpÃ§Ã£o 2 â€” Via API REST (com Postman, Insomnia, ou frontend)

1. Envia um `POST` para `/api/users/` com JSON:

   ```json
   {
     "username": "ze",
     "password": "1234",
     "display_name": "ZÃ© Briguento",
     "phone": "912345678"
   }
   ```
2. O `UserSerializer` valida os dados e cria o objeto no banco.
3. O servidor devolve:

   ```json
   {
     "id": "a4f6c8d2-9c12-4a3a-9b72-5fa9e78f1f9a",
     "username": "ze",
     "display_name": "ZÃ© Briguento"
   }
   ```

---

## ğŸ§  5. LigaÃ§Ã£o entre Apps

* `UserProfile` (em `apps.users`) tem relaÃ§Ã£o OneToOne com `User`.
* `Post` (em `apps.posts`) pode referenciar `User` como autor.
* `Core` pode guardar entidades globais como `BaseModel`, `Audit`, etc.

Assim:

```
User â”€â”€â”€ 1:1 â”€â”€â”€ UserProfile
User â”€â”€â”€ 1:N â”€â”€â”€ Post
Post â”€â”€â”€ N:M â”€â”€â”€ UserProfile.favourites
```

---

## ğŸ§¾ 6. SequÃªncia prÃ¡tica para iniciar e popular o sistema

1. **Cria o superuser**

   ```bash
   python manage.py createsuperuser
   ```
2. **Entra no admin (`/admin`)** e adiciona:

   * UsuÃ¡rios
   * Categorias
   * Posts
   * AgÃªncias (se aplicÃ¡vel)
3. **Testa as rotas da API** com o Postman:

   * `GET /api/users/`
   * `POST /api/posts/`
4. **Integra o frontend** (caso exista) para consumir essas APIs.

---

